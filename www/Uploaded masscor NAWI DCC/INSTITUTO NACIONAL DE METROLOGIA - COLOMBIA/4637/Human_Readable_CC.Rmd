---
params: 
  title: "Calibration Certificate Information"
  author: "Calibrating Laboratory"
  address: na
  date: '`r format(Sys.Date(), "%B %d, %Y")`'
  NAWIDCC: na
  logoBolean: na
output: 
  pdf_document:
      keep_tex: true
header-includes:    
    \usepackage{fancyhdr, graphicx, eurosym, booktabs, xcolor, lastpage}
    \pagestyle{fancy}   
    \fancyhf{}
    \addtolength{\headheight}{1.0cm}
    \lhead{\IfFileExists{logo.png}{\includegraphics[width = 7cm]{logo.png}}}
    \lfoot{Page \thepage of~\pageref{LastPage}}
    \fancypagestyle{plain}{\pagestyle{fancy}}
    \renewcommand{\headrulewidth}{0pt}
    \usepackage{titling}
    \usepackage{booktabs}
    \usepackage{multicol}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(masscor)
library(knitr)

 # NAWIDCC <- readRDS('../ExampleFiles/DCC_NAWI_Balanza Mettler Toledo XPE 205_B743848411 _ AF-07090_2020-07-16.rds')
 NAWIDCC <- params$NAWIDCC

```

$~$

\begin{center}\textsc{\huge Calibration Certificate Information}\end{center}

# `r gsub("(?<!\\w)(.)","\\U\\1", tolower(params$author), perl = TRUE)`
### `r params$address`

$~$

## Certificate number: **`r NAWIDCC$add.info$CertificateNumber`**

$\hrulefill$

 \begin{tabular}{rp{0.7\linewidth}}
 \textbf{\large Object to calibrate:}&\textbf{\large Non Automatic Weighing Instrument (NAWI)}\\[3ex]
 \textbf{Identification:}&`r NAWIDCC$balanceID`\\
 \textbf{Serial:}&`r NAWIDCC$serial`\\
 \textbf{Calibration date:}&`r NAWIDCC$date`\\
 \textbf{Calibration place:}&`r NAWIDCC$add.info$CalibrationPlace`\\[2ex]
 \textbf{Responsible person:}&`r strsplit(x = NAWIDCC$add.info$ResponsiblePerson, split = ',')[[1]][1]`\\
                             &`r ifelse(is.na(strsplit(x = NAWIDCC$add.info$ResponsiblePerson, split = ',')[[1]][2]), '', strsplit(x = NAWIDCC$add.info$ResponsiblePerson, split = ',')[[1]][2])`\\
                             &`r ifelse(is.na(strsplit(x = NAWIDCC$add.info$ResponsiblePerson, split = ',')[[1]][3]), '', strsplit(x = NAWIDCC$add.info$ResponsiblePerson, split = ',')[[1]][3])`
                             \\[2ex]

\multicolumn{2}{@{}l}{\textit{Environmental conditions}}\\
\textbf{Ambient temperature:} & `r paste(NAWIDCC$Temp, ifelse(NAWIDCC$unitsENV[1] == 'deg.C', '$^oC$', NAWIDCC$unitsENV[1]), sep = ' ')`\\
\textbf{Barometric pressure:} & `r paste(NAWIDCC$p, NAWIDCC$unitsENV[2], sep = ' ')`\\
\textbf{Relative humidity:}   & `r paste(NAWIDCC$h, ifelse(NAWIDCC$unitsENV[3] == '%', '\\%', ''), sep = ' ')`\\
\end{tabular}

$\hrulefill$

\textbf{\large Balance readability:}&\textbf{\large Non Automatic Weighing Instrument (NAWI)}

$\hrulefill$


## Repeatability test resuls
```{r, echo = FALSE}
kable(t(apply(NAWIDCC$add.info$CompleteRepeatability, MARGIN = 2, 
              function(x) format(x, scientific = FALSE, 
                                 nsmall = abs(floor(log10(convertMassUnitsSI(NAWIDCC$d, from = NAWIDCC$standardUnits, to = NAWIDCC$orgRepUnits[1]))))))), 
      format = "simple", caption = paste0('Repeatability test data. Units: [', NAWIDCC$orgRepUnits[1], ']'), align = 'r',
      col.names = paste(rownames(NAWIDCC$add.info$CompleteRepeatability), '/', NAWIDCC$orgRepUnits[1], sep = ' '), booktabs = TRUE)
kable(cbind(format(NAWIDCC$rep$V1, scientific = FALSE, digits = 4),
            signif(NAWIDCC$rep$V2, 3)),
      format = "simple", caption = paste0('Repeatability test results. Units: [', NAWIDCC$orgRepUnits[1], ']'), 
      col.names = paste0(c('Load / ', 'Standard deviation / '), NAWIDCC$orgRepUnits[1]), 
      digits = c((abs(floor(log10(convertMassUnitsSI(NAWIDCC$d, from = NAWIDCC$standardUnits, to = NAWIDCC$orgRepUnits[1])))) - 1),
                 (abs(floor(log10(convertMassUnitsSI(NAWIDCC$d, from = NAWIDCC$standardUnits, to = NAWIDCC$orgRepUnits[1])))) + 1)),
      booktabs = TRUE, align = 'c')

# NAWIDCC$rep
```









directory: `r print(getwd())`
```{r}
print(getwd())
print(params$logoBolean)
class(NAWIDCC)
```